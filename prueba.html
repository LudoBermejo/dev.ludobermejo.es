<html>
<body>
<label for="rows">Rows</label>
<input type="text" id="rows" value="20"/>
<label for="cols">cols</label>
<input type="text" id="cols" value="20"/>
<button id="doit">Do it!</button>
<br>
<canvas id="maze" width="800" height="800"></canvas>
<br>

<script>
    function generateMaze(width, height) {
        var totalCells = (width*height)-1;

        var arrayCellsVisited = [];

        var positions = new Array();

        var walls = {
            rows: [],
            cols: []
        };

        for(var i=0;i<=width-1;i++) {
            walls.rows[i] = new Array();
            walls.cols[i] = new Array();
            positions[i] = new Array();
            for(var j=0;j<=height-1;j++) {
                walls.rows[i][j] = 1;
                walls.cols[i][j] = 1;
                positions[i][j] = 0
            }
        }


        var here = {
            x: Math.floor(Math.random() * width),
            y: Math.floor(Math.random() * height)
        }


        positions[here.x][here.y] = 1;


        //totalCells = 50;
        while(totalCells) {
            var neighbours = [ { x: here.x-1, y: here.y}, {x:here.x+1,y:here.y}, {x:here.x, y:here.y-1}, {x: here.x, y: here.y+1}]
            while(neighbours.length) {
                var r = Math.floor(Math.random() * neighbours.length-1)+1;
                var n = neighbours.splice(r,1)[0];

                if(n.x >= 0 && n.y >= 0 && n.x < width && n.y < height) {
                    if( positions[n.x][n.y] == 0) {
                        positions[n.x][n.y] = 1;

                        if(n.x > here.x) {
                            walls.cols[n.x][n.y] = 0;
                        } else if (n.x < here.x) {
                            walls.cols[here.x][here.y] = 0;
                        } else if(n.y > here.y) {
                            walls.rows[n.x][n.y] = 0;
                        } else if(n.y < here.y) {
                            walls.rows[here.x][here.y] = 0;
                        }

                        here = n;
                        totalCells--;
                        arrayCellsVisited.push(here);
                        break;
                    }
                }
            }

            if(neighbours == 0) {
                here = arrayCellsVisited.pop();
            }

        }

        return walls;

    }

    function drawWalls(walls) {

        var canvas = document.getElementById('maze');
        if (canvas.getContext){
            var ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.beginPath();

            var size = 20;
            for(var i=0;i<=walls.rows.length-1;i++) {
                for(var j=0;j<=walls.cols.length-1;j++) {
                    ctx.moveTo(i*size, j*size);
                    if(walls.rows[i][j]==1 && (i >0 || j  > 0)) {

                        ctx.moveTo(i*size, j*size);
                        ctx.lineTo((i+1)*size,j*size);
                    }

                    if(walls.cols[i][j]==1) {
                        ctx.moveTo(i*size, j*size);
                        ctx.lineTo(i*size,(j+1)*size);
                    }
                }
            }
            ctx.moveTo(i*size,0);
            ctx.lineTo(i*size,(j-1)*size);
            ctx.moveTo(i*size,j*size);
            ctx.lineTo(0,j*size);
            ctx.stroke();
        }

    }

    document.getElementById("doit").addEventListener("click", function() {
        if(!document.getElementById("rows").value || isNaN(document.getElementById("rows").value) || document.getElementById("rows").value > 40) {
            alert("we only accept numbers and a max of 40");
            return;
        }
        if(!document.getElementById("cols").value || isNaN(document.getElementById("cols").value) || document.getElementById("cols").value > 40) {
            alert("we only accept numbers and a max of 40");
            return;
        }
        drawWalls(generateMaze(document.getElementById("rows").value,document.getElementById("cols").value));
    });






</script>

</body>

</html>