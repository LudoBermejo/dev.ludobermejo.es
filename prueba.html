<html>
<body>

<script>


    var gameOfThronesCharacters =  [
        { "name": "Tywin", "family": "Lannister", "childOf": null},
        { "name": "Tywin", "family": "Lannister", "childOf": null },
        { "name": "Kewan", "family": "Lannister", "childOf": null },
        { "name": "Cersei", "family": "Lannister", "childOf": "Tywin" },
        { "name": "Jaime", "family": "Lannister", "childOf": "Tywin" },
        { "name": "Tyrion", "family": "Lannister", "childOf": "Tywin" },
        { "name": "Lancel", "family": "Lannister", "childOf": "Kewan" },

        { "name": "Stannis", "family": "Baratheon", "childOf": null },
        { "name": "Edric", "family": "Baratheon", "childOf": "Stannis" },
        { "name": "Shireen ", "family": "Baratheon", "childOf": "Stannis" },
        { "name": "Petyr", "family": "Baratheon", "childOf": "Stannis" },
        { "name": "Tommard", "family": "Baratheon", "childOf": "Stannis" },
        { "name": "Renly", "family": "Baratheon", "childOf": null },
        { "name": "Robert", "family": "Baratheon", "childOf": null },
        { "name": "Joffrey", "family": "Baratheon","childOf": "Robert" },
        { "name": "Mircella", "family": "Baratheon","childOf": "Robert" },
        { "name": "Tommen", "family": "Baratheon","childOf": "Robert" },

        { "name": "Holter", "family": "Tully" },
        { "name": "Catelyn", "family": "Tully", "childOf": "Holter" },
        { "name": "Lysa", "family": "Tully", "childOf": "Holter" },
        { "name": "Edmure", "family": "Tully", "childOf": "Holter" },
        { "name": "Robin", "family": "Tully", "childOf": "Lysa" }
    ]

    var makeFamilyTree = function(data, family, childOf) {
        var node = {};
        var filtered = gameOfThronesCharacters.filter(function(obj) {
            if(family != null) {

                return obj.childOf === childOf && obj.family === family
            } else {
                return obj.childOf === childOf
            }

        })

        filtered.map(function(character) {
            if(childOf === null) {
                if(!node[character.family]) node[character.family] = {};
                return node[character.family][character.name] = makeFamilyTree(data, family, character.name)
            } else {
                return node[character.name] = makeFamilyTree(data, family, character.name)
            }
        });

        return node;
    }

    var result = makeFamilyTree(gameOfThronesCharacters, null, null);
    console.log(JSON.stringify(result,null,2))

    var result = makeFamilyTree(gameOfThronesCharacters, "Lannister", null);
    console.log(JSON.stringify(result,null,2))

</script>

</body>

</html>